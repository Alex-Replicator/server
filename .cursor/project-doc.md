# Документация кода проекта Docker-сборка для PHP-проектов

## Docker Compose

### docker-compose.yml
**Описание**: Основной файл конфигурации Docker Compose, описывающий все сервисы
**Файл**: `docker-compose.yml` (строки 1-82)
**Функциональность**:
- Определяет 5 сервисов: nginx, php, mysql, memcached, adminer
- Настраивает сети и тома для данных
- Использует переменные окружения из файла .env
- Настраивает зависимости между сервисами (php зависит от mysql и memcached)

## Dockerfile

### PHP
**Описание**: Dockerfile для PHP 8.1 с необходимыми расширениями
**Файл**: `bin/php/8.1/Dockerfile` (строки 1-36)
**Функциональность**:
- Устанавливает PHP 8.1-fpm с необходимыми зависимостями
- Настраивает расширения: gd, pdo, mysqli, zip, intl, opcache, exif, mbstring, xml, curl, memcached
- Устанавливает Composer для управления зависимостями
- Настраивает пользователя и директории для логирования

### Nginx
**Описание**: Dockerfile для веб-сервера Nginx
**Файл**: `bin/nginx/Dockerfile` (строки 1-12)
**Функциональность**:
- Базируется на официальном образе nginx:1.25
- Копирует конфигурационные файлы
- Настраивает директории для логирования

### MySQL
**Описание**: Dockerfile для базы данных MySQL
**Файл**: `bin/mysql/Dockerfile` (строки 1-12)
**Функциональность**:
- Базируется на официальном образе mysql:8.0
- Копирует пользовательскую конфигурацию MySQL
- Настраивает директории для логирования и данных

### Memcached
**Описание**: Dockerfile для сервиса кэширования Memcached
**Файл**: `bin/memcached/Dockerfile` (строки 1-6)
**Функциональность**:
- Базируется на официальном образе memcached:1.6
- Настраивает параметры запуска (объем памяти, порт, пользователь)

## Конфигурации

### Nginx
**Описание**: Конфигурационные файлы для веб-сервера Nginx
**Файлы**:
- `config/nginx/nginx.conf` (строки 1-40) - основная конфигурация сервера
  - Настройки процессов, соединений, gzip, логирования
- `config/nginx/default.conf` (строки 1-30) - настройки виртуального хоста
  - Проксирование PHP-запросов на PHP-FPM
  - Настройка корневой директории, индексных файлов, обработки статических файлов

### PHP
**Описание**: Конфигурационные файлы для PHP
**Файлы**:
- `config/php/php.ini` (строки 1-33) - базовые настройки PHP
  - Лимиты памяти, загрузки файлов, настройки ошибок, сессий, opcache
- `config/php/php-fpm.conf` (строки 1-24) - настройки PHP-FPM
  - Настройки пула, процессов, соединений, логирования

### MySQL
**Описание**: Конфигурационные файлы для MySQL
**Файлы**:
- `config/mysql/my.cnf` (строки 1-33) - настройки MySQL сервера
  - Кодировка, соединения, InnoDB, логирование

## CI/CD

### GitHub Actions
**Описание**: Файлы конфигурации для CI/CD через GitHub Actions
**Файлы**:
- `.github/workflows/deploy.yml` (строки 1-29) - конфигурация для автоматического деплоя
  - Настройка тригеров (push в main/master)
  - Настройка SSH для безопасного подключения
  - Запуск скриптов деплоя с переменными окружения

## Скрипты

### Деплой
**Описание**: Скрипты для деплоя на удаленный сервер
**Файлы**:
- `scripts/deploy.sh` (строки 1-66) - основной скрипт деплоя
  - Копирование файлов Docker-сборки и кода проекта на удаленный сервер
  - Запуск контейнеров на удаленном сервере
- `scripts/sync-database.sh` (строки 1-58) - скрипт для синхронизации базы данных
  - Экспорт локальной базы данных и импорт на удаленном сервере

## Тестовые файлы

### Тестовый PHP-скрипт
**Описание**: Скрипт для проверки работоспособности сборки
**Файл**: `../src/public/index.php` (строки 1-160)
**Функциональность**:
- Проверка подключения к MySQL
- Проверка подключения к Memcached
- Отображение информации о PHP, расширениях
- Отображение переменных окружения в debug-режиме
